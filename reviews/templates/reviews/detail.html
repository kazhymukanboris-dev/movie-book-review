{% extends 'reviews/base.html' %}

{% block content %}
<div class="container" style="max-width: 900px; padding-top: 50px;">
    <div style="background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); padding: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);">
        
        <div style="display: flex; gap: 40px; align-items: flex-start; flex-wrap: wrap;">
            <div style="flex-shrink: 0;">
                {% if item.image_url %}
                <img src="{{ item.image_url }}" alt="{{ item.title }}" style="width: 250px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 224, 255, 0.2);">
                {% else %}
                <div style="width: 250px; height: 350px; background: #333; display: flex; align-items: center; justify-content: center; font-size: 4rem;">ðŸŽ¬</div>
                {% endif %}
            </div>

            <div style="flex-grow: 1;">
                <h1 style="font-size: 3rem; margin-bottom: 0.5rem; color: #fff;">{{ item.title }}</h1>
                <h3 style="color: var(--primary); margin-bottom: 1rem; font-weight: 600;">{{ item.author_or_director }}</h3>
                <span style="background: rgba(255,255,255,0.1); padding: 5px 12px; border-radius: 6px; font-size: 0.9rem; color: #cbd5e1; border: 1px solid rgba(255,255,255,0.2);">{{ item.release_year }}</span>
                
                <p style="margin-top: 25px; font-size: 1.1rem; line-height: 1.7; color: #e2e8f0;">
                    {{ item.description }}
                </p>
            </div>
        </div>

        <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 40px 0;">

        <h3 style="font-size: 1.8rem; margin-bottom: 25px;">User Reviews</h3>

        {% if user.is_authenticated %}
        <div style="background: rgba(0,0,0,0.2); padding: 25px; border-radius: 15px; margin-bottom: 35px; border-left: 4px solid var(--secondary);">
            <h4 style="margin-bottom: 15px; color: #fff;">Write a Review</h4>
            <form method="post">
                {% csrf_token %}
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: #cbd5e1;">Rating (1-5):</label>
                    {{ form.rating }}
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: #cbd5e1;">Comment:</label>
                    {{ form.comment }}
                </div>
                <button type="submit" class="btn" style="width: 100%;">Post Review</button>
            </form>
        </div>
        {% else %}
        <div style="background: rgba(255,0,0,0.1); padding: 15px; border-radius: 10px; margin-bottom: 30px; border: 1px solid rgba(255,0,0,0.2); text-align: center;">
            <p>Please <a href="{% url 'login' %}" style="color: var(--primary); font-weight: bold;">Login</a> to leave a review.</p>
        </div>
        {% endif %}

        <div style="display: flex; flex-direction: column; gap: 20px;">
            {% for review in item.reviews.all %}
            <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <strong style="color: var(--primary);">@{{ review.user.username }}</strong>
                    <span style="color: #fbbf24; font-weight: bold;">{{ review.rating }} â˜…</span>
                </div>
                <p style="color: #cbd5e1; font-style: italic;">"{{ review.comment }}"</p>
            </div>
            {% empty %}
            <p style="opacity: 0.5;">No reviews yet. Be the first!</p>
            {% endfor %}
        </div>

    </div>
</div>
{% endblock %}